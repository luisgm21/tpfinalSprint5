<div class="container mt-4">
  <div class="hero">
    <h1 class="page-title">Demo: gestión de países</h1>
    <p class="muted-small">Proyecto de ejemplo con CRUD, búsquedas y visualización usando Express, EJS y DataTables.</p>

  <% var _last = (typeof locals !== 'undefined' && locals.lastCountry) ? locals.lastCountry : null; %>
  <% if (_last) { %>
    <h2 class="mt-4">Último país agregado: <%= _last.name %></h2>
    <div class="card mb-3">
      <div class="card-body">
        <p><strong>Nombre:</strong> <%= _last.name %></p>
  <% // Acomodar capital cuando es string o array --> mostrar '-' si no existe %>
  <% const _capitals = (Array.isArray(_last.capital) ? _last.capital.join(', ') : (_last.capital || '-')); %>
  <p><strong>Capital(es):</strong> <%= _capitals %></p>
        <p><strong>Población:</strong> <%= _last.population?.toLocaleString() || 'N/A' %></p>
        <p><strong>Área:</strong> <%= _last.area?.toLocaleString() || 'N/A' %> km²</p>
        <p><strong>Código (cca3):</strong> <%= _last.abr %></p>
        <% const _borders = Array.isArray(_last.borders) ? _last.borders.join(', ') : (_last.borders || '-'); %>
        <p><strong>Fronteras:</strong> <%= _borders %></p>
        <p><strong>Timezones:</strong></p>
        <% if (Array.isArray(_last.timezones) && _last.timezones.length) { %>
          <ul>
            <% _last.timezones.forEach(tz => { %>
              <li><%= tz %></li>
            <% }) %>
          </ul>
        <% } else if (_last.timezones) { %>
          <p><%= _last.timezones %></p>
        <% } else { %>
          -
        <% } %>
        <p><strong>Gini:</strong></p>
        <% if (_last.gini && Object.keys(_last.gini).length) { %>
          <ul>
            <% Object.entries(_last.gini).forEach(([yr,val]) => { %>
              <li><%= yr %>: <%= val %></li>
            <% }) %>
          </ul>
        <% } else { %>
          -
        <% } %>
        <p><strong>Languages:</strong></p>
        <% if (_last.languages && Object.keys(_last.languages).length) { %>
          <ul>
            <% Object.entries(_last.languages).forEach(([k,v]) => { %>
              <li><%= k %>: <%= v %></li>
            <% }) %>
          </ul>
        <% } else { %>
          -
        <% } %>
        <p><strong>Creador:</strong> <%= _last.creador || '-' %></p>
      </div>
    </div>
  <% } %>
  </div>
</div>
